"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var markdown_it_1 = tslib_1.__importDefault(require("markdown-it"));
var js_yaml_1 = tslib_1.__importDefault(require("js-yaml"));
function default_1(md, separates) {
    return meta.bind(null, md, separates);
}
exports.default = default_1;
function get(state, line) {
    var pos = state.bMarks[line];
    var max = state.eMarks[line];
    return state.src.substr(pos, max - pos);
}
function meta(md, separates, state, start, end) {
    if (start !== 0 || state.blkIndent !== 0) {
        return false;
    }
    if (state.tShift[start] < 0) {
        return false;
    }
    if (!(separates[0] || ['---']).some(function (sep) { return get(state, start).match(new RegExp("^" + sep + "$")); })) {
        return false;
    }
    var data = [];
    var line = start;
    var _loop_1 = function () {
        line++;
        var str = get(state, line);
        if ((separates[1] || ['---']).some(function (sep) { return str.match(new RegExp("^" + sep + "$")); })) {
            return "break";
        }
        if (state.tShift[line] < 0) {
            return "break";
        }
        data.push(str);
    };
    while (line < end) {
        var state_1 = _loop_1();
        if (state_1 === "break")
            break;
    }
    md.meta = js_yaml_1.default.safeLoad(data.join('\n'), { json: true }) || {};
    state.line = line + 1;
    return true;
}
//# sourceMappingURL=meta.js.map